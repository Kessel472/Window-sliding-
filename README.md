# AES Key Randomness Analyzer

## Overview

This project is a **randomness analyzer for AES key generation** that uses the **sliding window technique** to detect potential bias in cryptographic keys generated by OpenSSL.

The program generates a 128-bit AES key using OpenSSL's `RAND_bytes()` function and analyzes it for randomness bias by examining patterns within the key bytes. Specifically, it uses a sliding window algorithm to find the longest subarray with at most K distinct integers, which can reveal if the key has repeating patterns that might indicate poor randomness.

## How It Works

### Key Generation
The program generates a random 128-bit (16-byte) AES key using OpenSSL's cryptographically secure random number generator (`RAND_bytes()`).

### Sliding Window Analysis
The sliding window technique is applied to analyze the generated key:

1. **Window Sliding Function**: Finds the length of the longest subarray with at most K distinct integers
2. **Analysis Parameter**: Currently set to K=1 (checking for repeated values)
3. **Bias Detection**: If the longest subarray with the same value is 4 or more bytes, the key is flagged as potentially biased

### Interpretation
- **Result < 4**: The key appears to have good randomness distribution
- **Result ≥ 4**: The key exhibits significant bias (multiple consecutive bytes with the same value)

## Dependencies

- **OpenSSL**: Required for cryptographic random number generation
  - Headers included from the `openssl/` directory
  - Specifically uses `openssl/rand.h` for `RAND_bytes()`

## Compilation

This project requires a C++ compiler with C++11 support or later and the OpenSSL library.

### Example compilation command:
```bash
g++ -std=c++11 main.cpp -o main -lssl -lcrypto
```

Or on Windows with MSVC:
```bash
cl /EHsc main.cpp /link libssl.lib libcrypto.lib
```

## Usage

Simply run the compiled executable:

```bash
./main
```

Or on Windows:
```bash
main.exe
```

## Output

The program displays:

1. The generated AES key in hexadecimal format
2. Analysis results showing either:
   - The length of the longest subarray with at most 1 distinct integer (for good randomness)
   - A warning if significant bias is detected (longest subarray ≥ 4)

### Example Output

```
====================================================================================
Generated AES Key in main (hex): a3 7f 2e 91 5c 48 d6 b2 3a 9e 71 c4 85 0d f3 6b
====================================================================================
The length of the longest subarray with at most 1 distinct integers is: 1
====================================================================================
```

Or if bias is detected:

```
====================================================================================
Generated AES Key in main (hex): a3 7f 7f 7f 7f 48 d6 b2 3a 9e 71 c4 85 0d f3 6b
====================================================================================
The generated AES key exhibits significant bias with Longest subarray length: 5
====================================================================================
```

## Technical Details

### Sliding Window Algorithm

The `windowSLider()` function implements a two-pointer sliding window technique:
- Maintains a frequency map of integers in the current window
- Expands the window to the right while the number of distinct integers ≤ K
- Contracts the window from the left when the constraint is violated
- Tracks the maximum window size throughout the process

This provides O(n) time complexity for analyzing the key.

## Purpose

This tool is designed to:
- Test the quality of random number generation in cryptographic contexts
- Demonstrate the sliding window algorithm for pattern detection
- Provide a simple check for obvious biases in generated keys

**Note**: This is a simple bias detection tool and should not be considered a comprehensive cryptographic randomness test. Production cryptographic systems should use established randomness test suites like NIST SP 800-22.

## License

No license specified.
